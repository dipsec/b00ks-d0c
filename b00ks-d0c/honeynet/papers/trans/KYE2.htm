<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./KYE2_files/filelist.xml">
<title>Know Your Enemy II: Traquer leurs mouvements</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>none</o:Author>
  <o:LastAuthor>Everett Spitzner</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>6</o:TotalTime>
  <o:LastPrinted>2000-01-05T23:34:00Z</o:LastPrinted>
  <o:Created>2000-01-07T03:55:00Z</o:Created>
  <o:LastSaved>2000-01-07T03:55:00Z</o:LastSaved>
  <o:Pages>6</o:Pages>
  <o:Words>3824</o:Words>
  <o:Characters>21802</o:Characters>
  <o:Company> </o:Company>
  <o:Lines>181</o:Lines>
  <o:Paragraphs>43</o:Paragraphs>
  <o:CharactersWithSpaces>26774</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:HyphenationZone>21</w:HyphenationZone>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>0</w:DisplayVerticalDrawingGridEvery>
  <w:UseMarginsForDrawingGridOrigin/>
  <w:Compatibility>
   <w:FootnoteLayoutLikeWW8/>
   <w:ShapeLayoutLikeWW8/>
   <w:AlignTablesRowByRow/>
   <w:ForgetLastTabAlignment/>
   <w:LayoutRawTableWidth/>
   <w:LayoutTableRowsApart/>
  </w:Compatibility>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	mso-ansi-language:FR;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	mso-ansi-language:FR;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:56.7pt .8in 42.55pt .8in;
	mso-header-margin:0in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
</head>

<body lang=EN-US style='tab-interval:35.4pt'>

<div class=Section1>

<div style='border:solid windowtext .5pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=MsoPlainText style='text-align:justify;border:none;mso-border-alt:
solid windowtext .5pt;padding:0in;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=FR style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>Cet
article a été traduit de l’anglais par OUAH (OUAH_hotmail.com),
http://www.multimania.com/ouah. La version originale est de Lance Spitzner
(lspitz@ksni.net) et peut-être obtenue à http://www.enteract.net/~lspitz.<span
style="mso-spacerun: yes">  </span>Pour tout commentaire, venez sur le channel
de<span style="mso-spacerun: yes">  </span>hacking français&nbsp;: #root sur
irc.kewl.org<o:p></o:p></span></p>

</div>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=FR style='font-size:16.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>Know Your Enemy II</span></b><span lang=FR style='font-size:
16.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>: Traquer leurs mouvements<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Cet article est le deuxième d'une série de trois
articles.<span style="mso-spacerun: yes">  </span>Dans le premier, Know Your
Enemy, nous avons parlés des outils et des méthodes du Script Kiddie. <span
style="mso-spacerun: yes"> </span>Particulièrement, comment ils sondent à la
recherches des vulnérabilités et puis passent à l'attaque. Le troisième article
parle de ce que font les script kiddies une fois le statut root obtenu. En
particulier comment ils dissimulent leurs traces et ce qu'ils font après. Cette
article-ci, le deuxième, nous explique comment traquer leurs mouvements.
Exactement comme les militaires, vous voulez traquer les méchants et savoir ce
qu'ils font. Nous parlerons de ce que vous pourrez et ne pourrez apprendre pas avec
vos logs systèmes. Vous devez être capable de voir que vous êtes en train
d'êtres scanné, de savoir pourquoi vous l'êtes. Les exemples donnés s'intéresse
à Linux mais peuvent s'appliquer à presque n'importe quelle autre déclinaison
d'Unix. Gardez à l'esprit qu'il n'existe aucune méthode sure pour traquer tous
les actes de votre ennemie. Cependant, cet article est un bon début.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><u><span lang=FR
style='font-family:Arial'>Sécuriser ses logs<o:p></o:p></span></u></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Cet article ne porte pas sur la détection d'intrusion
(IDS), il existe déjà beaucoup de très bons articles qui parlent de cela. Si
vous êtes intéressé par la détection d'intrusion, je recommande de jeter un
coup d'oeil à &quot;Network Flight Recorder&quot; ou snort. Cet article
s'intéresse aux recherches de l'intelligence. Particulièrement, comment savoir
ce que fait l'ennemi en passant en revue vos logs système. Vous serez surpris
de savoir toues les informations que vous trouverez dans vos propres logs
systèmes. Cependant, avant que nous puissions parler de passer en revue vos
logs, nous devons d'abord parler de la manière de sécuriser vos logs. Vos
fichiers logs sont sans valeur si vous ne pouvez pas avoir confiance en leur
intégrité. La première chose que la plupart des hackers font sur un système qui
vient d'être compromis est de modifier les fichiers log. Il existe plein de
rootkits qui élimineront leur présence des fichiers logs (comme cloak) ou les
modifient (comme l'exécutable de syslog trojaned). Donc la première chose à
faire avant de passer en revue vos logs est de les sécuriser.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Cela veut dire que vous devrez utiliser un serveur de
log distant. Indépendamment de la façon de sécuriser votre système vous ne
pouvez pas avoir confiance en vos logs dans un système compromis. Si vous ne
faites rien le hacker pourra simplement faire un rm - rf / * sur votre système pour
le formater complètement. Ceci rendra la récupération des logs un peu
difficile. Pour vous protéger contre cela, vous aurez besoin que vos systèmes
log le trafic à la fois localement et sur un serveur distant. Je vous
recommande de faire de votre log server un système consacré, càd que la seule
chose qu'il devrait faire serait de rassembler les logs des autres systèmes. Si
l'argent est un problème vous pouvez installer un ordinateur Linux qui agisse
en tant que log server. Ce serveur devra être hautement sécurisé, avec tous les
services désactivés, permettant seulement un accès à la console. (voir
l'Armoring Linux pour un exemple).<span style="mso-spacerun: yes">  </span>En
outre, assurez-vous que le port UDP 514 soit bloqué ou filtré par un firewall
de votre connexion au net. Ceci protège votre log server de la réception
d'information mauvaise ou non autorisée de l'Internet.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Pour ceux parmi vous qui aiment être plus malin,
quelque chose que moi j'aime bien faire, c'est de recompiler syslogd pour qu'il
lise un fichier de configuration différent comme<span style="mso-spacerun:
yes">  </span>/var/tmp/.conf. Ainsi le hacker ne se rendra pas compte de où se
trouve le vrai fichier de configuration. Cela se fait simplement en changeant
l'entrée &quot;/etc/syslog.conf&quot; dans le code source par le fichier que
vous voulez. Nous configurons alors notre nouveau fichier de<span
style="mso-spacerun: yes">  </span>configuration pour logger à la fois
localement et sur le log server (voir l'exemple). Assurez vous de garder une
copie standard de /etc/syslog.conf qui log l'activité locale. Quoique ce fichier
de configuration soit maintenant inutile, ceci enlèvera des soupçons du hacker
sur l'existence de notre log distant. Une autre possibilité pour votre système
est d'utiliser une méthode de log sécurisée. Une méthode est de remplacer votre
exécutable syslogd par quelque chose qui a un contrôle d'intégrité et une plus
grande palette d'options. Syslog-ng est une possibilité et vous pouvez le
trouver à http://www.balabit.hu/products/syslog-ng.html<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>La plupart des logs que nous utiliserons sont ceux
qui sont stockés sur le log server distant. Comme on l'a dit plus haut, nous
pouvons être assez confiants de l'intégrité de ces logs puisqu'ils sont sur un
système sécurisé et distant. En outre, puisque tous les systèmes loggent depuis
une source unique, on a ainsi une vue plus générale et donc plus claire. Nous
pouvons rapidement passer en revue ce qui arrive à tous les systèmes depuis une
seule source. Le seul cas où vous voudriez passer en revue les logs stockés
localement sur un système serait pour les comparer avec les résultats du log
server. Vous pouvez déterminer si les logs locaux ont été modifiés en les
comparant aux logs distants.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><u><span lang=FR
style='font-family:Arial'>Identification<o:p></o:p></span></u></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>En regardant les entrées de vos logs, vous pouvez
normalement voir si vous êtes victimes d'un scanner de port. La plupart des
Script Kiddies scannent un réseau pour une vulnérabilité donnée. Si vos logs
montrent que la plupart de vos systèmes ont des connexions du même système
distant, sur le même port, il y a beaucoup de chance que ce soit un scan pour
un exploit. En fait l'ennemi a un exploit pour une certaine vulnérabilité et
fait des scans en espérant la retrouver chez vous. Quand ils la trouvent, ils
l'exploitent. Pour la plupart des systèmes Linux, TCP Wrappers est installé par
défaut.<span style="mso-spacerun: yes">  </span>Ainsi, nous trouverions la
plupart de ces connexions dans /var/log/secure. Pour les autres systèmes Unix,
nous pouvons logger toutes les connexions d'inetd en lançant inetd avec le flag
&quot;-f&quot; &quot;, démon de service. Un scan à la recherche d'exploit
typique ressemblerait à ce qu'il y a ci-dessous.<span style="mso-spacerun:
yes">  </span>Ici nous avons un scannage source pour la vulnérabilité de
wu-ftpd.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>/var/log/secure <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 10 13:43:48 mozart in.ftpd[6613]: connect from
192.168.11.200 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 10 13:43:51 bach in.ftpd[6613]: connect from
192.168.11.200 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 10 13:43:54 hadyen in.ftpd[6613]: connect from
192.168.11.200 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 10 13:43:57 vivaldi in.ftpd[6613]: connect from
192.168.11.200 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 10 13:43:58 brahms in.ftpd[6613]: connect from
192.168.11.200 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Ici nous voyons la source 192.168.11.200 scanner
notre réseau. Remarquez comme cette source scanne séquentiellement chaque IP
(cela n'est pas toujours le cas). C'est l'avantage d'avoir un serveur de log,
vous pouvez plus facilement identifier des choses dans votre réseau puisque
toutes les logs sont centralisés. Les connexions répétées au port 21, ftp, ont
indiqué qu'ils recherchaient particulièrement la vulnérabilité de wu-ftpd. Nous
avons juste déterminé ce que le hacker recherchait.<span style="mso-spacerun:
yes">  </span>Souvent, les scans s'effectuent par phases. Quelqu'un publie le
code pour un exploit sur imap et vous verrez soudainement un assaut de scan sur
imap dans vos log. Le mois suivant vous serez frappés par le ftp. Une
excellente source pour les exploits récents est http://www.cert.org/advisories/
Parfois, des outils scanneront pour plein d'exploits en même temps, ainsi vous
verrez une source unique se connecter à plusieurs ports.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Gardez à l'esprit que si vous ne loggez pas les
connexions d'un service, vous ne saurez pas si vous êtes scanné pour celui-ci.
Par exemple, la plupart des connexions rpc ne sont pas loggées. Cependant,
beaucoup de services peuvent simplement être ajoutés à /etc/inetd.conf pour le
logging avec TCP Wrappers. Par exemple, vous pouvez ajouter une entrée dans
/etc/inetd.conf pour NetBus. Vous pouvez configurer TCP Wrapper pour simplement
refuser le service et logger les connexions (voir &quot;Intrusion
Detection&quot; pour plus d'information sur ce sujet).<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><u><span lang=FR
style='font-family:Arial'>Quels ont les outils?<o:p></o:p></span></u></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Parfois vous pouvez vraiment déterminer les outils
utilisés pour scanner votre réseau. Certains des outils les plus basiques
scannent pour un certain exploit comme ftp-scan.c. Si un seul port ou une seule
vulnérabilité est scannée par les hackers, c'est qu'ils utilisent probablement
un de ces programmes &quot;single mission&quot;. Mais il existe des outils qui
scannent pour une variété de vulnérabilités ou de faiblesses, les deux outils
très populaires sont sscan de jsbach et nmap de Fyodor. J'ai choisi ces deux
outils parce qu'ils représentent les deux catégories d'outils de scan. Je vous
recommande fortement d'utiliser ces outils contre votre propre réseau, vous pourrez
êtres surpris des résultats:)<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style='mso-tab-count:
1'>          </span>sscan représente l'outil de scan &quot;qui fait
tout&quot;<span style="mso-spacerun: yes">  </span>des Script Kiddie et c'est
probablement un des meilleurs qui existent. Il scanne rapidement un réseau pour
une variété de vulnérabilité (dont les cgi-bin). Il est facilement
configurable, vous permettant d'ajouter des scans pour de nouveaux
exploits.<span style="mso-spacerun: yes">  </span>Vous donner simplement au
programme un réseau et un masque de réseau, et lui fait tout le reste pour
vous.<span style="mso-spacerun: yes">  </span>Cependant, l'utilisateur doit
être root pour l'utiliser. Les résultats sont extrêmement faciles à interpréter
(c'est pourquoi il est si populaire): il donne un résumé concis de beaucoup de
services vulnérables. Tout que vous avez à faire est de lancer sscan contre un
réseau et chercher le mot &quot;VULN&quot; dans la sortie et puis lancer
l'&quot;exploit du jour&quot; (NdT: en <span style='mso-tab-count:1'> </span>français
dans le texte). Ci-dessous un exemple de sscan contre le système mozart
(172.17.6.30).<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>otto #./sscan -o 172.17.6.30 <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>--------------------------&lt;[ * report for host mozart
* <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>&lt;[ tcp port: 80 (http) ]&gt;<span style="mso-spacerun:
yes">       </span>&lt;[ tcp port: 23 (telnet) ]&gt; <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>&lt;[ tcp port: 143 (imap) ]&gt;<span
style="mso-spacerun: yes">      </span>&lt;[ tcp port: 110 (pop-3) ]&gt; <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>&lt;[ tcp port: 111 (sunrpc) ]&gt;<span
style="mso-spacerun: yes">    </span>&lt;[ tcp port: 79 (finger) ]&gt; <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>&lt;[ tcp port: 53 (domain) ]&gt;<span
style="mso-spacerun: yes">     </span>&lt;[ tcp port: 25 (smtp) ]&gt; <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>&lt;[ tcp port: 21 (ftp) ]&gt; <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>--&lt;[ *OS*: mozart: os detected: redhat linux 5.1 <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>mozart: VULN: linux box vulnerable to named overflow. <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>-&lt;[ *CGI*: 172.17.6.30: tried to redirect a
/cgi-bin/phf request. <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">   </span><span style="mso-spacerun: yes">       </span>-&lt;[ *FINGER*:
mozart: root: account exists. <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>--&lt;[ *VULN*: mozart: sendmail will 'expn' accounts for
us <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>--&lt;[ *VULN*: mozart: linux bind/iquery remote buffer
overflow <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>--&lt;[ *VULN*: mozart: linux mountd remote buffer overflow
<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>---------------------------&lt;[ * scan of mozart
completed *<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style='mso-tab-count:
1'>          </span>Nmap est un programme de &quot;données brutes&quot;: il ne
vous dit pas quelles vulnérabilités existent, il vous dit plutôt quels ports
sont ouverts, vous en déterminez les conséquences. Nmap est rapidement devenu
le scanner de ports de choix, et pour cause. Il prend le meilleur de plusieurs
scanners de port et met toutes ces fonctionnalités dans un <span
style='mso-tab-count:1'> </span>seul outil, dont la détection de l'OS,
plusieurs options d'assemblage de paquet, le scan à la fois de UDP et de TCP,
randomization, etc. Cependant, vous avez besoin des <span style='mso-tab-count:
1'>  </span>qualifications de gestion de réseau pour utiliser ce programme et
pour interpréter les données. Ci-dessous, un exemple de nmap lancé contre le
même système.<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style='mso-tab-count:
1'>          </span>otto #nmap -sS -O 172.17.6.30 <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>Starting nmap V. 2.08 by Fyodor (fyodor@dhp.com,
www.insecure.org/nmap/) <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>Interesting ports on mozart (172.17.6.30): <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>Port<span style="mso-spacerun: yes">    </span>State<span
style="mso-spacerun: yes">       </span>Protocol<span style="mso-spacerun:
yes">  </span>Service <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>21<span style="mso-spacerun: yes">      </span>open<span
style="mso-spacerun: yes">        </span>tcp<span style="mso-spacerun:
yes">        </span>ftp <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>23<span style="mso-spacerun: yes">      </span>open<span
style="mso-spacerun: yes">        </span>tcp<span style="mso-spacerun:
yes">        </span>telnet <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>25<span style="mso-spacerun: yes">      </span>open<span
style="mso-spacerun: yes">        </span>tcp<span style="mso-spacerun:
yes">        </span>smtp <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>37<span style="mso-spacerun: yes">      </span>open<span
style="mso-spacerun: yes">        </span>tcp<span style="mso-spacerun:
yes">        </span>time <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>53<span style="mso-spacerun: yes">      </span>open<span
style="mso-spacerun: yes">        </span>tcp<span style="mso-spacerun:
yes">        </span>domain <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>70<span style="mso-spacerun: yes">      </span>open<span
style="mso-spacerun: yes">        </span>tcp<span style="mso-spacerun:
yes">        </span>gopher <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>79<span style="mso-spacerun: yes">      </span>open<span
style="mso-spacerun: yes">   </span><span style="mso-spacerun:
yes">     </span>tcp<span style="mso-spacerun: yes">        </span>finger <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>80<span style="mso-spacerun: yes">      </span>open<span
style="mso-spacerun: yes">        </span>tcp<span style="mso-spacerun:
yes">        </span>http <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>109<span style="mso-spacerun: yes">     </span>open<span
style="mso-spacerun: yes">        </span>tcp<span style="mso-spacerun:
yes">        </span>pop-2 <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>110<span style="mso-spacerun: yes">     </span>open<span
style="mso-spacerun: yes">        </span>tcp<span style="mso-spacerun:
yes">        </span>pop-3 <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>111<span style="mso-spacerun: yes">     </span>open<span
style="mso-spacerun: yes">        </span>tcp<span style="mso-spacerun:
yes">        </span>sunrpc <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>143<span style="mso-spacerun: yes">     </span>open<span
style="mso-spacerun: yes">        </span>tcp<span style="mso-spacerun:
yes">       </span><span style="mso-spacerun: yes"> </span>imap2 <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>513<span style="mso-spacerun: yes">     </span>open<span
style="mso-spacerun: yes">        </span>tcp<span style="mso-spacerun:
yes">        </span>login <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>514<span style="mso-spacerun: yes">     </span>open<span
style="mso-spacerun: yes">        </span>tcp<span style="mso-spacerun:
yes">        </span>shell <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>635<span style="mso-spacerun: yes">     </span>open<span
style="mso-spacerun: yes">        </span>tcp<span style="mso-spacerun:
yes">        </span>unknown <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>2049<span style="mso-spacerun: yes">    </span>open<span
style="mso-spacerun: yes">        </span>tcp<span style="mso-spacerun:
yes">        </span>nfs <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>TCP Sequence Prediction: Class=truly random <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">                                   </span>Difficulty=9999999 (Good luck!) <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>Remote operating system guess: Linux 2.0.35-36 <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:28.35pt;text-align:justify;text-indent:
-28.35pt'><span lang=FR style='font-family:Arial'><span style="mso-spacerun:
yes">          </span>Nmap run completed -- 1 IP address (1 host up) scanned in
2 seconds<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>En passant en revue vos logs, vous pouvez déterminer
lequels de ces outils ont été utilisés contre vous. Pour faire cela, vous devez
comprendre comment ces programmes fonctionnent. D'abord, un scan de sscan sera
loggé comme suit (c'est un scan normal avec aucune modification d'aucun fichier
de configuration):<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>/var/log/secure <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 19:18:56 mozart in.telnetd[11634]: connect
from 192.168.11.200 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 19:18:56 mozart imapd[11635]: connect from
192.168.11.200 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 19:18:56 mozart in.fingerd[11637]: connect
from 192.168.11.200 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 19:18:56 mozart ipop3d[11638]: connect from
192.168.11.200 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 19:18:56 mozart in.telnetd[11639]: connect
from 192.168.11.200 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 19:18:56 mozart in.ftpd[11640]: connect from
192.168.11.200 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 19:19:03 mozart ipop3d[11642]: connect from
192.168.11.200 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 19:19:03 mozart imapd[11643]: connect from
192.168.11.200 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 19:19:04 mozart in.fingerd[11646]: connect
from 192.168.11.200 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 19:19:05 mozart in.fingerd[11648]: connect
from 192.168.11.200 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>/var/log/maillog <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:01:58 mozart imapd[11667]: command stream
end of file, while reading line user=???<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>host=[192.168.11.200] <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:01:58 mozart ipop3d[11668]: No such file or
directory while reading line user=???<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>host=[192.168.11.200] <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:02:05 mozart sendmail[11675]: NOQUEUE:
[192.168.11.200]: expn root <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>/var/log/messages <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:03:09 mozart telnetd[11682]: ttloop:<span
style="mso-spacerun: yes">  </span>peer died: Invalid or incomplete multibyte
or wide character <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:03:12 mozart ftpd[11688]: FTP session
closed <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>sscan fait aussi des scans à la recherche des bugs cgi-bin.
Ces scans ne seront pas loggés par syslogd, vous les trouverez dans access_log.
J'ai décidés de les inclure quand même pour votre apprentissage:)<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>/var/log/httpd/access_log <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>192.168.11.200 - - [14/Apr/1999:16:44:49 -0500]
&quot;GET /cgi-bin/phf HTTP/1.0&quot; 302 192 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>192.168.11.200 - - [14/Apr/1999:16:44:49 -0500]
&quot;GET /cgi-bin/Count.cgi HTTP/1.0&quot; 404 170 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>192.168.11.200 - - [14/Apr/1999:16:44:49 -0500]
&quot;GET /cgi-bin/test-cgi HTTP/1.0&quot; 404 169 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>192.168.11.200 - - [14/Apr/1999:16:44:49 -0500]
&quot;GET /cgi-bin/php.cgi HTTP/1.0&quot; 404 168 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>192.168.11.200 - - [14/Apr/1999:16:44:49 -0500]
&quot;GET /cgi-bin/handler HTTP/1.0&quot; 404 168 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>192.168.11.200 - - [14/Apr/1999:16:44:49 -0500]
&quot;GET /cgi-bin/webgais HTTP/1.0&quot; 404 168 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>192.168.11.200 - - [14/Apr/1999:16:44:49 -0500]
&quot;GET /cgi-bin/websendmail HTTP/1.0&quot; 404 172 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>192.168.11.200 - - [14/Apr/1999:16:44:49 -0500]
&quot;GET /cgi-bin/webdist.cgi HTTP/1.0&quot; 404 172 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>192.168.11.200 - - [14/Apr/1999:16:44:49 -0500]
&quot;GET /cgi-bin/faxsurvey HTTP/1.0&quot; 404 170 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>192.168.11.200 - - [14/Apr/1999:16:44:49 -0500]
&quot;GET /cgi-bin/htmlscript HTTP/1.0&quot; 404 171 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>192.168.11.200 - - [14/Apr/1999:16:44:49 -0500]
&quot;GET /cgi-bin/pfdisplay.cgi HTTP/1.0&quot; 404 174 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>192.168.11.200 - - [14/Apr/1999:16:44:49 -0500]
&quot;GET /cgi-bin/perl.exe HTTP/1.0&quot; 404 169 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>192.168.11.200 - - [14/Apr/1999:16:44:49 -0500]
&quot;GET /cgi-bin/wwwboard.pl HTTP/1.0&quot; 404 172 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>192.168.11.200 - - [14/Apr/1999:16:44:50 -0500]
&quot;GET /cgi-bin/ews/ews/architext_query.pl<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>HTTP/1.0&quot; 404 187 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>192.168.11.200 - - [14/Apr/1999:16:44:50 -0500]
&quot;GET /cgi-bin/jj HTTP/1.0&quot; 404 163 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Notez comme la connexion a été faite en entier (SYN,
SYN-ACK, ACK) pour tous les ports, puis fermée. C'est parce sscan veut
déterminer ce qui se passe sur les services. Non seulement sscan veut savoir si
votre port ftp est ouvert, mais aussi QUEL daemon ftp est actif. La même chose
peut être dite pour les ports imap, pop, etc.<span style="mso-spacerun: yes"> 
</span>Cela se remarque dans les traces de sniffing avec sniffit, un programme
souvent utilisé pour sniffer des mots de passe.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>mozart $ cat 172.17.6.30.21-192.168.11.200.7238 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>220 mozart.example.net FTP server (Version
wu-2.4.2-academ[BETA-17](1) Tue Jun 9 10:43:14 EDT<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>1998) ready. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Comme on l'a vue plus haut une connexion complète a
été faite pour déterminer quelle version de wu-ftpd était exécutée. Quand vous
voyez des connexions complètes dans vos logs c'est que vous avez certainement
été scanné par un programme d'exploit. Ces programmes font des connexions
complètes pour déterminer ce que vous êtes en train d'exécuter.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Nmap comme la plupart des scanners de port, s'en fout
de savoir CE QUE vous exécuter,<span style="mso-spacerun: yes">  </span>mais
veut savoir SI vous exécuter des services particuliers. Pour cela, nmap a un
puissant ensemble d'options, vous laissant déterminer quelle sorte de connexion
ouvrir, dont SYN, FIN, Xmas, Null, etc. Pour une description détaillée de ces
options, jetez un coup d'oeil à http://www.insecure.org/nmap/nmap_doc.html. En
raison de ces options, vos logs seront différents suivant les options choisies
par l'utilisateur à distance. Une connexion faite avec le flag -sT est une connexion
complète donc les logs seront similaires à sscan, toutefois par défaut nmap
scan plus de ports.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>/var/log/secure <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:20:50 mozart in.rlogind[11706]: connect
from 192.168.11.200 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:20:51 mozart in.fingerd[11708]: connect
from 192.168.11.200 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:20:51 mozart ipop2d[11709]: connect from
192.168.11.200 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:20:51 mozart in.rshd[11710]: connect from
192.168.11.200 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:20:51 mozart gn[11711]: connect from
192.168.11.200 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:20:51 mozart gn[11711]: error: cannot execute
/usr/sbin/gn: No such file or directory<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:20:52 mozart in.timed[11712]: connect from
192.168.11.200 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:20:52 mozart imapd[11713]: connect from
192.168.11.200 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:20:52 mozart ipop3d[11714]: connect from
192.168.11.200 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:20:52 mozart in.telnetd[11715]: connect
from 192.168.11.200 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:20:52 mozart in.ftpd[11716]: connect from
192.168.11.200 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><span style="mso-spacerun: yes"> </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Une chose à retenir est l'option -D (ou decoy). Cette
option de nmap permet à l'utilisateur de spoofer son adresse source. Il est
possible que vous voyez des scans<span style="mso-spacerun: yes">  </span>de 15
sources différentes en même temps, mais que seulement une d'entre elles est la
vraie. Il est extrêmement difficile de déterminer laquelle des 15 était la
vraie adresse source. Mais le plus souvent, les utilisateurs choisiront le flag
-sS pour le scannage. C'est une option de scan de port furtif car seulement un
paquet SYN est envoyé.<span style="mso-spacerun: yes">  </span>Si le système
disant répond, la connexion est immédiatement stoppée avec un RST. Les logs de
ce genre de scans ont l'apparence de ce qui est retranscrit plus bas (NOTE:
seulement les cinq premières entrées ont été notées ici).<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>/var/log/secure <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:25:08 mozart in.rshd[11717]: warning: can't
get client address: Connection reset by peer <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:25:08 mozart in.rshd[11717]: connect from
unknown <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:25:09 mozart in.timed[11718]: warning:
can't get client address: Connection reset by peer <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:25:09 mozart in.timed[11718]: connect from
unknown <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:25:09 mozart imapd[11719]: warning: can't
get client address: Connection reset by peer <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:25:09 mozart imapd[11719]: connect from
unknown <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:25:09 mozart ipop3d[11720]: warning: can't
get client address: Connection reset by peer <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:25:09 mozart ipop3d[11720]: connect from
unknown <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:25:09 mozart in.rlogind[11722]: warning:
can't get client address: Connection reset by peer <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 21:25:09 mozart in.rlogind[11722]: connect
from unknown <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Remarquez toutes les erreurs dans les connexions.
Puisque la séquence SYN-ACK est stoppée avant qu'une connexion complète puisse
être établie, le démon ne peut pas déterminer le système source. Les logs
montrent que vous avez été scanné mais malheureusement vous ne savez pas par
qui. Ce qui est bien plus alarmant, c'est que sur la plupart des autres systèmes
(y compris les nouveaux noyaux Linux) aucune de ces erreurs n'aurait été
loggée. Pour citer Fyodor &quot;...basé sur tous les messages 'connection reset
by peer'&quot;. C'est une singularité de Linux 2.0.XX -- pratiquement tous les
autres système (dont le noyau 2.2 et<span style="mso-spacerun: yes"> 
</span>les plus récent noyaux 2.1) ne montreront rien. Ce bug (accept() qui
retourne une valeur avant l'accomplissement de la connexion en 3 temps (NdT: la
fameuse 3-way handshake) a été réparé.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Nmap inclut d'autres options furtives, comme -sF,
-sX, -sN où différents flags sont utilisés. Ceci est ce à quoi ressemblent les
logs pour de tels scans:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>/var/log/secure <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Remaquez ici qu'il n'y a aucun logs! Hum effrayant,
vous venez d'être scanné et ne pouvez même pas le savoir. Chacun des trois
types de scans donne les mêmes résultats, toutefois vous pouvez loggez
entièrement le scan seulement du premier type, -sT (connexion complète). Pour
détecter ces scans furtifs vous devrez utiliser un autre programme de log comme
tcplogd ou ippl. Certains firewalls commerciaux détecteront aussi et loggeront
tous ces scans (J'ai confirmé cela dans<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>&quot;Checkpoint Firewall 1&quot;) <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><u><span lang=FR
style='font-family:Arial'>Ont-ils eu l'accès?<o:p></o:p></span></u></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Une fois que vous avez remarqué avoir été scanné et
déterminer ce qu'ils recherchaient, la grande question qui suit est &quot;Sont
ils entrés?&quot;. La plupart d'exploits à distance d'aujourd'hui sont basées
sur des buffer overflow (aussi connu sous écrasement de pile). En gros un
buffer overflow arrive quand un programme (souvent un daemon) reçoit plus
d'entrées qu'il ne l'avait prévu, de ce fait recouvrant des zones critiques de
la mémoire. Un certain code est alors exécuté, qui normalement donne le statut
root à l'utilisateur. Pour plus d'information sur les buffers overflows, lisez
l'excellent article de Aleph1 à ftp://ftp.technotronic.com/rfc/phrack49-14.txt.
<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Vous pouvez normalement identifier des attaques par
buffer overflows dans le fichier log /var/log/messages (ou /var/adm/messages
pour d'autres systèmes Unix) pour des attaques comme mountd. Vous verrez
également des logs similaires dans maillog pour de telles attaques contre
imapd. Une attaque par buffer overflow ressemblerait à ceci:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 04:20:51 mozart mountd[6688]: Unauthorized
access by NFS client 192.168.11.200. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 04:20:51 mozart syslogd: Cannot glue message
parts together <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 14 04:20:51 mozart mountd[6688]: Blocked attempt
of 192.168.11.200 to mount <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P3Û3À°^[Í~@3Ò3À~KÚ°^FÍ~@þÂuô1À°^BÍ~@~EÀubëb^V¬&lt;ýt^FþÀt^Këõ°0þÈ~HFÿëì^°^B~I^FþÈ~IF^D°^F~IF^H°f1ÛþÃ~IñÍ~@~I^F°^Bf~IF^L°*f~IF^N~MF^L~IF^D1À~IF^P°^P~IF^H°fþÃÍ~@°^A~IF^D°f³^DÍ~@ë^DëLëR1À~IF^D~IF^H°fþÃÍ~@~HÃ°?1ÉÍ~@°?þÁÍ~@°?þÁÍ~@¸.bin@~I^F¸.sh!@~IF^D1À~HF^G~Iv^H~IF^L°^K~Ió~MN^H~MV^LÍ~@1À°^A1ÛÍ~@èEÿÿÿÿýÿPrivet
ADMcrew~P(-^E^H(-^E^H(-^E^H(-^E^H(-^E^H(-^E^H(-^E^H(-^E^H(-^E^H(Apr 14
04:20:51mozart
^H(-^E^H(-^E^H(-^E^H(-^E^H(-^E^H(-^E^H(-^E^H(-^E^H(-^E^H(-^E^H(-^E^H(-^E^H(-^E^H-^E^H(-^E^H(-^E^H(-^E^H(-^E^H(-^E^H(-^E^H(-^E^H(-^E^H(-^E^H(-^E^H(-^E^H(-^E^H-^E^H(-^E^H(-^E^H(-^E^H(-^E^H(-^E^
H(-^E^H(-^E^H(-^E^H(-^E^H(-^E^H(-^E^H(-^E^H(-^E <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Si vous voyez quelque chose de la sorte dans vos
fichiers logs, cela veut dire que quelqu'un a essayé d'exécuter un exploiter
sur votre système. Il est difficile de déterminer si l'exécution de l'exploit a
été couronée de succès. Une façon de savoir après la tentative d'exploit est de
regarder s’ il y a des connexions d'une source distante sur votre système.
S’ils se sont loggés sans problème depuis le système distant, alors ils ont
accès à votre système. Un autre indice est de regarder s’il<span
style="mso-spacerun: yes">  </span>y a des comptes &quot;moof&quot;,
&quot;rewt&quot;, &quot;crak0&quot;, ou &quot;w0rm&quot; qui ont été ajoutés à
votre fichier mot de passe /etc/passwd. Ces comptes, d'uid 0, sont ajoutés par
certains des scripts d'exploits les plus connus. Une fois qu'un hacker obtient
un accès, normalement la première chose qu'ils font est de nettoyer vos logs et
de trojaner votre programme de log (syslogd), pour plus d'information allez
voir Know Your Enemy III. À partir de ce moment, vous ne recevrez aucun log de
votre système vu que tout a été compromis.<span style="mso-spacerun: yes"> 
</span>Ce que vous pouvez faire après est le sujet d'un autre article :). En
attendant je vous recommande de lire: http://www.cert.org/nav/recovering.html<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Pour m'aider à trouver des anomalies dans mes
fichiers logs, j'ai développé un shell script qui scan mes logs pour moi. Pour
des information plus détaillées sur comment analyser des fichiers logs, lisez
ceci envoyé par Marcus Ranum (Bourne shell script ou Korn shell script)<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><span style="mso-spacerun: yes"> </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><u><span lang=FR
style='font-family:Arial'>Conclusion<o:p></o:p></span></u></p>

<p class=MsoPlainText style='text-align:justify'><u><span lang=FR
style='font-family:Arial'><o:p></o:p></span></u></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Vos fichiers logs peuvent vous dire beaucoup au sujet
de l'ennemi. Mais la première chose à faire est de garantir l'intégrité de vos
fichiers logs. Un des meilleurs moyens de faire cela est d'utiliser un serveur
de log distant qui reçoit et stocke le logs des autres systèmes. Une fois
sécurisé vous pourrez identifier les anomalies dans vos fichiers logs. En se
basant sur les entrées des logs vous pouvez déterminer ce que le hacker
recherche et potentiellement quels outils ils utilisent. Avec cette
connaissance vous pourrez mieux sécuriser et protéger votre réseau.<o:p></o:p></span></p>

</div>

</body>

</html>
